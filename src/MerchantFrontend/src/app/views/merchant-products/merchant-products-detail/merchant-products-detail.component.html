<form clrForm clrLayout="vertical" [formGroup]="form" *ngIf="null !== product">
  <h3>{{'MERCHANT.PRODUCTS.DETAILS.HEADLINE' | translate}}</h3>
  <clr-select-container>
    <label>{{'MERCHANT.PRODUCTS.DETAILS.PRODUCT_TYPE' | translate}}</label>
    <select clrSelect name="types" formControlName="productType"
    (ngModelChange)="potentiallyAddServiceBookingTemplate($event)">
      <option value="product">{{'COMMON.PRODUCT' | translate}}</option>
      <option value="storeWindow">{{'COMMON.SHOWCASE' | translate}}</option>
      <option value="voucher">{{'COMMON.VOUCHER' | translate}}</option>
      <option value="service">{{'COMMON.SERVICE' | translate}}</option>
    </select>
  </clr-select-container>
  <clr-input-container>
    <label>{{'MERCHANT.PRODUCTS.DETAILS.PRODUCT_NAME' | translate}}</label>
    <input
      clrInput
      type="text"
      formControlName="name"
      name="example"
      required
    />
  </clr-input-container>
  <clr-textarea-container>
    <label>{{'MERCHANT.PRODUCTS.DETAILS.DESCRIPTION_TEXT' | translate}}</label>
    <textarea
      clrTextarea
      formControlName="description"
      name="description"
    ></textarea>
  </clr-textarea-container>
  <clr-input-container>
    <label>{{'COMMON.ACTIVE' | translate}}</label>
    <input clrInput type="checkbox" formControlName="active" clrToggle />
  </clr-input-container>
  <h3>{{'MERCHANT.PRODUCTS.DETAILS.PRODUCT_IMAGE' | translate}}</h3>
  <portal-single-image-upload-container
    [existingImageUrl]="product.media[0].url"
    (newImageSelected)="imageSelected($event)">

  </portal-single-image-upload-container>

  <ng-container *ngIf="'storeWindow' !== form.get('productType').value">
    <h3>{{'COMMON.PRICE' | translate}}</h3>
    <clr-input-container>
      <label>{{'COMMON.PRICE' | translate}}</label>
      <input
        clrInput
        type="number"
        min="1"
        step="any"
        name="price"
        formControlName="price"
      />
      <clr-icon shape="euro"></clr-icon>
    </clr-input-container>
    <clr-select-container>
      <label>{{'COMMON.TAX_RATE' | translate}}</label>
      <select clrSelect name="tax" formControlName="tax">
        <option value="7">7% {{'COMMON.VALUE_ADDED_TAX' | translate}}</option>
        <option value="19">19% {{'COMMON.VALUE_ADDED_TAX' | translate}}</option>
      </select>
    </clr-select-container>
  </ng-container>

  <ng-container *ngIf="'service' === form.get('productType').value" formGroupName="serviceBookingTemplate">
    <h3>{{'COMMON.SERVICE' | translate}}</h3>

    <clr-select-container>
      <label>Service Typ</label>
      <select clrSelect formControlName="type">
        <option value="default">Default</option>
          <option value="webinar">Webinar</option>
          <option value="consulting">Consulting</option>
      </select>
    </clr-select-container>

    <div formArrayName="dates" class="clr-row">
      <ng-container *ngFor="let date of serviceBookingTemplateDates().controls; index as dateIndex">
        <div [formGroupName]="dateIndex" class="clr-col-lg-3 clr-col-md-3 clr-col-3">

          <div class="card">
            <div class="card-block">
              <div class="card-title">
                Termin {{dateIndex + 1}}
              </div>

              <div class="card-text">
                <clr-date-container>
                  <label>Start Datum:</label>
                  <input type="datetime" clrDate formControlName="start" name="start" />
                </clr-date-container>

                <clr-date-container>
                  <label>End Datum:</label>
                  <input type="datetime" clrDate formControlName="end" name="end" />
                </clr-date-container>
              </div>
            </div>
            <div class="card-footer">
                <button class="btn btn-sm btn-link btn-danger" (click)="removeServiceBookingDate(dateIndex)">Termin löschen</button>
            </div>
          </div>
        </div>
      </ng-container>
    </div>

    <button class="btn btn-default" style="margin-top: 1.2rem;" type="submit" (click)="addServiceBookingDate()">Neuen Termin hinzufügen</button>
  </ng-container>

  <div class="button-wrapper">
    <button
      class="btn btn-primary"
      type="button"
      (click)="saveProduct()"
      [disabled]="form.invalid || saveInProgress"
    >
      {{'COMMON.SAVE' | translate}}
    </button>
  </div>
</form>

<span *ngIf="this.form">
{{this.form.value | json}}
</span>
